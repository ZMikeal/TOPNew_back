<include file="Public/headerr" /> 

<div class="right_col" role="main" style="">
  
          
<div class="row">
              <div class="col-md-12 col-sm-12 col-xs-12" style="height:100%;">
                <div class="x_panel">
                  <div class="x_title">
                    <h2>用户未删除人员 <small></small></h2>
                    <ul class="nav navbar-right panel_toolbox">
                      <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                      </li>
                      <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                        <ul class="dropdown-menu" role="menu">
                          <li><a href="#">Settings 1</a>
                          </li>
                          <li><a href="#">Settings 2</a>
                          </li>
                        </ul>
                      </li>
                      <li><a class="close-link"><i class="fa fa-close"></i></a>
                      </li>
                    </ul>
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content">
                    <!-- <p class="text-muted font-13 m-b-30">
                      DataTables has most features enabled by default, so all you need to do to use it with your own tables is to call the construction function: <code>$().DataTable();</code>
                    </p> -->
                    <table id="datatable" class="table table-striped table-bordered">
                      <thead>
                        <tr>
                          <th>id</th>
                          <th>用户名称</th>
                          <th>工号</th>
                          <th>科室</th>
                          <th>岗位</th>
                          <th>上级</th>
                          <th>等级</th>
                          <th>操作</th>
                        </tr>
                      </thead>


                      <tbody>
                       <volist name="vse" id="vo">
                       <tr>
                       <td>{$vo.id}</td>
                       <td>{$vo.username}</td>
                       <td>{$vo.id_employee}</td>
                       <td>{$vo.user_office}</td>
                       <td>{$vo.user_job}</td>
                       <td>{$vo.user_leader}</td>
                       <td><switch name="vo.id_level">
                            <case value="2">计划管理员</case>
                            <case value="3">科员</case>
                            <case value="4">科长</case>
                            <case value="5">院长</case>
                            <case value="7">VSE</case>
                            <default />default
                           </switch>
                       </td>
                       <td style="width:250px;">
                       <a class="btn btn-default btn-lg active" href="#" onclick="fn(this)" role="button" data-toggle="modal"  data-target="#bianji">编辑</a>
                       <a id="{$vo.id}" class="btn btn-default btn-lg active" onclick="fnn(this)">删除</a>
                       <a id="{$vo.id}" class="btn btn-default btn-lg active" style="width:37%;" onclick="recover(this)">密码重置</a>
                       </td>
                       </tr>
                       </volist>
                      </tbody>
                    </table>
                    <a class="btn btn-default btn-lg active" href="#" role="button" data-toggle="modal"  data-target="#login">添加</a>
                  </div>
                </div>
              </div>


              <div class="col-md-12 col-sm-12 col-xs-12" style="height:100%;">
                <div class="x_panel">
                  <div class="x_title">
                    <h2>用户删除人员 <small></small></h2>
                    <ul class="nav navbar-right panel_toolbox">
                      <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                      </li>
                      <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                        <ul class="dropdown-menu" role="menu">
                          <li><a href="#">Settings 1</a>
                          </li>
                          <li><a href="#">Settings 2</a>
                          </li>
                        </ul>
                      </li>
                      <li><a class="close-link"><i class="fa fa-close"></i></a>
                      </li>
                    </ul>
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content">
                    <!-- <p class="text-muted font-13 m-b-30">
                      DataTables has most features enabled by default, so all you need to do to use it with your own tables is to call the construction function: <code>$().DataTable();</code>
                    </p> -->
                    <table id="datatable1" class="table table-striped table-bordered">
                      <thead>
                        <tr>
                          <th>id</th>
                          <th>用户名称</th>
                          <th>工号</th>
                          <th>科室</th>
                          <th>岗位</th>
                          <th>上级</th>
                          <th>等级</th>
                          <th>操作</th>
                        </tr>
                      </thead>


                      <tbody>
                       <volist name="vse1" id="vo">
                       <tr>
                       <td>{$vo.id}</td>
                       <td>{$vo.username}</td>
                       <td>{$vo.id_employee}</td>
                       <td>{$vo.user_office}</td>
                       <td>{$vo.user_job}</td>
                       <td>{$vo.user_leader}</td>
                       <td><switch name="vo.id_level">
                            <case value="2">计划管理员</case>
                            <case value="3">科员</case>
                            <case value="4">科长</case>
                            <case value="5">院长</case>
                            <case value="7">VSE</case>
                            <default />default
                           </switch></td>
                       <td>
                       <a id="{$vo.id}" class="btn btn-default btn-lg active" onclick="fnnn(this)">恢复</a>
                       <a id="{$vo.id}" class="btn btn-default btn-lg active" onclick="dele(this)">彻底删除</a>
                       </td>
                       </tr>
                       </volist>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
</div>
</div>


<div class="modal fade" id="login" tabindex="-1" role="dialog" 
   aria-labelledby="myModalLabel" aria-hidden="true" style="float: right; border: 1px solid #333;"> 
     <div class="modal-dialog">
      <div class="modal-content">
       <div class="modal-header">
        <button type="button" class="close" 
           data-dismiss="modal" aria-hidden="true">
            &times;
        </button>
        <h4 class="modal-title" id="myModalLabel">
           添加人员：
        </h4>
       </div>
       <!--登陆主体 -->
      <div class="modal-body">
          
         <table class="table">
          <tr>
            <th>姓名:</th>
            <td>
            <div class="form-group has-success">
            <input type="text" id="username" class="form-control"></div>
            </td>
          </tr>
          <tr>
            <th>工号:</th>
            <td><input type="text" id="id_employee" class="form-control"></td>
          </tr>
          <tr>
            <th>等级:</th>
            <td><select id="level1" class="form-control">
              <option value="3">科员</option>
              <option value="4">科长</option>
              <option value="5">部长</option>
              <option value="7">VSE</option>
            </select></td>
          </tr>
          <tr>
            <th>科室:</th>
            <td><input type="text" id="office1" class="form-control"></td>
          </tr>
          <tr>
            <th>上级:</th>
            <td><select id="leader1" class="form-control">
              <volist name="leader" id="l">
               <option value="{$l.username}">{$l.username}</option>
              </volist>
            </select></td>
          </tr>
          <tr>
            <th>岗位:</th>
            <td><input type="text" id="job" class="form-control"></td>
          </tr>
         </table>
         <input type="button" id="sub-form" class="btn-block btn-lg btn-primary" value="提交">
          
      </div>
      </div><!-- /.modal-content -->
      </div><!-- /.modal -->
</div>



<div class="modal fade" id="bianji" tabindex="-1" role="dialog" 
   aria-labelledby="myModalLabel" aria-hidden="true" style="float: right; border: 1px solid #333;"> 
     <div class="modal-dialog">
      <div class="modal-content">
       <div class="modal-header">
        <button type="button" class="close" 
           data-dismiss="modal" aria-hidden="true">
            &times;
        </button>
        <h4 class="modal-title" id="myModalLabel">
           编辑人员：
        </h4>
       </div>
       <!--编辑主体 -->
      <div class="modal-body">
          
         <table class="table">
          <tr>
            <th>工号:</th>
            <td><input type="hidden" id="text0" class="form-control">
          <input type="text" id="text2" name="text[]" class="form-control" disabled="disabled"></td>
          </tr>
          <tr>
            <th>人员名称:</th>
          <td><input type="text" id="text1" name="text[]" class="form-control" disabled="disabled"></td>
          </tr>
          <tr>
            <th>科室:</th>
            <td><input type="text" id="text3" name="text[]" class="form-control"></td>
          </tr>
          <tr>
            <th>上级:</th>
            <td><select id="leader" class="form-control">
              <option value="">默认</option>
              <volist name="leader" id="l">
               <option value="{$l.username}">{$l.username}</option>
              </volist>
            </select></td>
          </tr>
          <tr>
            <th>岗位:</th>
            <td><input type="text" id="text4" name="text[]" class="form-control"></td>
          </tr>
          <tr>
            <th>等级:</th>
            <td><select id="level" class="form-control">
              <option value="">默认</option>
              <option value="3">科员</option>
              <option value="4">科长</option>
              <option value="5">部长</option>
              <option value="7">VSE</option>
            </select></td>
          </tr>
         </table>
         <input type="button" id="sub-mod" class="btn-block btn-lg btn-primary" value="提交">
          
      </div>
      </div><!-- /.modal-content -->
      </div><!-- /.modal -->
</div>


<include file="Public/foot" /> 
 
    <!-- Datatables -->
    <script src="__PUBLIC__/vendors/datatables.net/js/jquery.dataTables.min.js"></script>
    <script src="__PUBLIC__/vendors/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
    <!-- Datatables -->
<script type="text/javascript">
$(document).ready(function() {
     
        $('#datatable').dataTable();

        $('#datatable1').dataTable();

      });

    $(function(){
    $("#sub-form").click(function(){
      var username = $("#username").val();
      var id_employee = $("#id_employee").val();
      var level1 = $("#level1").val();
      var leader1 = $("#leader1").val();
      var office1 = $("#office1").val();
      var job = $("#job").val();
      var action = "userform";
      if(username=="" || id_employee==""|| office1==""|| job==""){
        alert("不能为空!");
        return false;
      }
      $.ajax({
        type:"POST",
        url:action,
        dataType:"json",
        data:{"username":username,"id_employee":id_employee,"level1":level1,"leader1":leader1,"office1":office1,"job":job},
        success:function(data){
          if(data.success==1){
            alert('添加成功!');
            location.href='user.html';
          }
          if(data.success==-1){  
            alert('工号已存在!');
          }
          if(data.success==0){ 
          //alert(data.username);
          alert("添加失败！");
            return false;
          }
        }
      });
  });
    $("#sub-mod").click(function(){
      var id = $("#text0").val();
      var office = $("#text3").val();
      var employee = $("#text2").val();
      var leader = $("#leader").val();
      var job = $("#text4").val();
      var level = $("#level").val();
      var action = "usermod";
      if(office==""||job==""){
        alert("不能为空！");
        return false;
      }
      $.ajax({
        type:"POST",
        url:action,
        dataType:"json",
        data:{"id":id,"office":office,"level":level,"leader":leader,"job":job,},
        success:function(data){
          if(data.success==1){
            alert('编辑成功!');
            //alert(data.ss);
            location.href='user.html';
          }
          if(data.success==-1){  
            alert('该vse已有该工程!');
          }
          if(data.success==0){ 
          //alert(data.username);
          alert("编辑失败！");
            return false;
          }
        }
      });
  });
  });
    function fn(tt){
       var tr1 = tt.parentNode.parentNode;  
       for(var i=0;i<=4;i++)
       {
            document.getElementById("text"+i).value = tr1.cells[i].innerText;
       }
    }
    function fnn(nn){
       var re=nn.id;
       //alert(re);
       var action = "deleteuser";
    if (confirm("确定要删除吗？")) 
             {      
      $.ajax({
        type:"GET",
        url:action,
        data:{"vid":re},
        dataType:"json",
        success:function(data){
          if(data.success==1){  
             alert("删除成功!");
              location.href='user.html';
          }
          else{
          alert("删除失败！");
          }
        }
      });
    }
  }
  function recover(nn){
       var re=nn.id;
       //alert(re);
       var action = "recoveruserpas";
    if (confirm("确定要重置密码吗？")) 
             {      
      $.ajax({
        type:"GET",
        url:action,
        data:{"vid":re},
        dataType:"json",
        success:function(data){
          if(data.success==1){  
             alert("重置成功!");
              location.href='user.html';
          }
          else{
          alert("重置失败！");
          }
        }
      });
    }
  }
  function fnnn(nn){
       var re=nn.id;
       //alert(re);ser
       var action = "recoveruser";
    if (confirm("确定要恢复吗？")) 
             {      
      $.ajax({
        type:"GET",
        url:action,
        data:{"vid":re},
        dataType:"json",
        success:function(data){
          if(data.success==1){  
             alert("恢复成功!");
              location.href='user.html';
          }
          else{
          alert("恢复失败！");
          }
        }
      });
    }
  }
  function dele(nn){
       var re=nn.id;
       //alert(re);ser
       var action = "deleuser";
    if (confirm("确定要彻底删除吗？")) 
             {      
      $.ajax({
        type:"GET",
        url:action,
        data:{"vid":re},
        dataType:"json",
        success:function(data){
          if(data.success==1){  
             alert("删除成功!");
              location.href='user.html';
          }
          else{
          alert("删除失败！");
          }
        }
      });
    }
  }
      
    </script>
    <!-- /Datatables -->
